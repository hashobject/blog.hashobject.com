<!DOCTYPE html>
<html itemscope="" itemtype="http://schema.org/BlogPosting"><head><meta charset="utf-8"><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"><meta content="width=device-width, initial-scale=1.0, user-scalable=no" name="viewport"><meta content="Anton Podviaznikov (anton@hashobject.com)" itemprop="author" name="author"><meta content="clojure, amazon beanstalk, https, ssl, aws, heroku, deploy, web app, amazon route 53, naked domain" itemprop="keywords" name="keywords"><meta content="Short guide how to deploy Clojure web app on Amazon Beanstalk with HTTPS support with almost no cost" itemprop="description" name="description"><meta content="en" itemprop="inLanguage"><meta content="2013-06-03" itemprop="dateCreated"><meta content="2013-09-16" itemprop="dateModified"><meta content="2013-06-26" itemprop="datePublished"><title itemprop="name">Configure Clojure web app to run with HTTPS support on Amazon Beanstalk</title><link href="/favicon.ico" rel="shortcut icon"><link href="https://plus.google.com/118068495795214676039" rel="publisher"><link href="humans.txt" rel="author"><link href="feed.rss" rel="alternate" title="RSS" type="application/rss+xml"><link href="https://github.com/hashobject/blog.hashobject.com/issues/1" rel="discussionUrl"><link href="http://blog.hashobject.com/clojure-webapp-with-https-support-on-amazon-beanstalk" rel="canonical"><link href="/css/app.css" rel="stylesheet" type="text/css"><link href="http://fonts.googleapis.com/css?family=PT+Sans" rel="stylesheet" type="text/css"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-41533076-2', 'hashobject.com');
  ga('send', 'pageview');</script></head><body><div class="off-canvas-wrap"><div class="inner-wrap"><div class="contain-to-grid"><nav class="top-bar hide-for-small" data-topbar="" role="navigation"><ul class="title-area"><li class="name"><h1><a href="http://blog.hashobject.com"><div class="logo"></div></a></h1></li></ul><section class="top-bar-section"><ul class="right"><li><a href="http://hashobject.com">Home</a></li><li class="active"><a href="http://blog.hashobject.com">Blog</a></li><li><a href="http://os.hashobject.com">Open Source</a></li></ul></section></nav><nav class="tab-bar show-for-small"><a class="left-off-canvas-toggle menu-icon"><span>Hashblog</span></a></nav><a class="exit-off-canvas"></a><aside class="left-off-canvas-menu"><ul><li><label>Hashobject</label></li><li><a href="http://hashobject.com">Home</a></li><li class="active"><a href="http://blog.hashobject.com">Blog</a></li><li><a href="http://os.hashobject.com">Open Source</a></li></ul></aside></div><div class="row"><div class="post small-12 columns"><h1 itemprop="name">Configure Clojure web app to run with HTTPS support on Amazon Beanstalk</h1><p><!-- name: Configure Clojure web app to run with HTTPS support on Amazon Beanstalk description: Short guide how to deploy Clojure web app on Amazon Beanstalk with HTTPS support with almost no cost author: Anton Podviaznikov author_email: anton@hashobject.com author_url: http://twitter.com/podviaznikov author_github: podviaznikov author_twitter: podviaznikov author_avatar: /images/anton-avatar.png location: Guatemala City, Guatemala date_created: 2013-06-03 date_modified: 2013-09-16 date_published: 2013-06-26 headline: in_language: en keywords: clojure, amazon beanstalk, https, ssl, aws, heroku, deploy, web app, amazon route 53, naked domain discussion_url: https://github.com/hashobject/blog.hashobject.com/issues/1 canonical_url: http://blog.hashobject.com/clojure-webapp-with-https-support-on-amazon-beanstalk --><h2>Intro</h2></p><p>Currently there are several options for hosting Clojure web apps.</p><p>The obvious one is <a href='http://heroku.com'>Heroku</a> with their great <a href='https://devcenter.heroku.com/articles/clojure-web-application'>guide</a>.</p><p>However, if your web app needs SSL support on custom domain you immediately need to pay $20/month for the <a href='https://addons.heroku.com/ssl'>Heroku addon</a>.</p><p>The second option is to host your Clojure web app on Amazon EC2. This can be done almost for free for the first year if your app is small enough. Check out AWS <a href='http://aws.amazon.com/free/'>Free Usage Tier</a>. Hosting web app on Amazon EC2 has its own upsides and downsides.</p><p>The third solution (probably, there are many other options out there) is the one, that I want to describe in this post.</p><h2>Amazon Beanstalk</h2><p>Amazon has product in their AWS suite which reminds Heroku a lot.</p><p>It's called <a href='http://aws.amazon.com/elasticbeanstalk/'>Beanstalk</a>. According to Amazon docs:</p><blockquote><p>New AWS customers who are eligible for the AWS free usage tier can deploy an application in Elastic Beanstalk for free. </p></blockquote><p>There are some resources that can help Clojure developers to deploy their apps on Beanstalk. I recommend reading this <a href='http://www.ctdean.com/2012/04/10/aws-beanstalk-on-clojure.html'>blog post</a> and using <a href='https://github.com/weavejester/lein-beanstalk'>lein-beanstalk</a> plugin.</p><p>Basically you will be able to deploy you app using following command: <code>lein beanstalk deploy prod</code> Where 'prod' is the name of you environment that you need to specify creating Beanstalk app.</p><p>Creating Amazon Beanstalk application is easy. Just follow <a href='http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create&#95;deploy&#95;Java.html'>official docs</a>. You can choose Tomcat 6 or Tomcat 7 as container (both 32 and 64 bit).</p><h2>How to get SSL certificate</h2><p>Usually I'm getting my SSL certificates from <a href='http://www.startssl.com/'>StartSSL</a>.</p><p>They are providing Class 1 SSL certificates for 1 year for free.</p><p>You will get from them (after registration and applying for certificate) two files:</p><ul><li>certificate (let's call it server.crt).    File content starts with '-----BEGIN CERTIFICATE-----'.</li><li>private key (let's call it ssl.key).    File content starts with '-----BEGIN RSA PRIVATE KEY-----'.</li></ul><p>You shouldn't share these files.</p><h2>How to setup custom domain(naked domain) for Beanstalk application</h2><p>I recommend to use <a href='http://aws.amazon.com/route53/'>Amazon Route 53</a> for managing DNS records. If you have a hosted zone on Amazon Route 53 for your domain name, then you need just to create new Record set of type A.</p><p>Select "Yes" for "Alias" field and you will be able to select Elastic Load balancer that works with your Beanstalk instance in the "Alias target" field.</p><p>After this is done you will be able to reach your web app using naked domain name (e.x. example.com instead of www.example.com).</p><h2>How to configure HTTPS support for you Beanstalk application</h2><p>There is a nice <a href='http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/configuring-https.html'>article</a> in Amazon docs about how to add HTTPS support for your Beanstalk application.</p><p>You need to upload your SSL certificate using command <code>iam-servercertupload -b server.crt -k ssl.key -s server</code> You will get Amazon Resource name for your certificate similar to <code>arn:aws:iam::123456789012:server-certificate/cert</code></p><p>After uploading SSL certificate you need to edit configuration for your Beanstalk app. In the "Load balancer" section specify:</p><ul><li>Secure listener port: 443</li><li>Protocol: HTTPS</li><li>SSL Certificate ID: Amazon Resource name that you received after certificate upload.</li></ul><h2>Conclusion</h2><p>In this post I tried to describe steps needed to have Clojure web app deployed to Amazon Beanstalk and available behind your own secure naked domain.</p><p>Described setup will cost almost nothing for the first year.</p><aside class="post-meta small-12 columns"><img class="author-avatar" src="/images/anton-avatar.png" title="Anton Podviaznikov"><div class="meta-info"><div><span class="meta-label">Written by</span><a class="author-name" href="http://twitter.com/podviaznikov">Anton Podviaznikov</a></div><div><span class="meta-label">Published: </span><span>Jun 26, 2013</span></div><div><span class="meta-label">Modified: </span><span>Sep 16, 2013</span></div><div><span class="meta-label">Published in: </span><span>Guatemala City, Guatemala</span></div><div><span class="meta-label">Reading time: </span><span>3 mins</span></div></div></aside></div><footer class="post-discussion small-12 columns">Discussion for this post available on <a href="https://github.com/hashobject/blog.hashobject.com/issues/1">GitHub</a>.</footer></div><footer class="row"><p class="license small-12 columns">Except as otherwise noted, the content of this site is licensed
     under the <a href='http://creativecommons.org/licenses/by/3.0/'>Creative Commons Attribution 3.0 License</a>,
     and code samples are licensed under the
     <a href='http://opensource.org/licenses/eclipse-1.0'>Eclipse Public License 1.0</a>.</p><script src="/js/vendor.js" type="text/javascript"></script><script>$(document).foundation();</script></footer></div></div></body></html>