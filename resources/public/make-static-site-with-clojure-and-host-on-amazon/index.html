<!DOCTYPE html>
<html itemscope="" itemtype="http://schema.org/BlogPosting"><head><meta charset="utf-8"><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"><meta content="width=device-width, initial-scale=1.0, user-scalable=no" name="viewport"><meta content="Anton Podviaznikov (anton@hashobject.com)" itemprop="author" name="author"><meta content="clojure, amazon s3, web site, amazon route 53, amazon cloudfront, markdown, html, github, amazon route 53, clojure hiccup" itemprop="keywords" name="keywords"><meta content="Short guide how to create static web site using Clojure and host it on Amazon S3 and CloudFront" itemprop="description" name="description"><meta content="en" itemprop="inLanguage"><meta content="2013-07-06" itemprop="dateCreated"><meta content="2013-07-06" itemprop="dateModified"><meta content="2013-07-06" itemprop="datePublished"><title itemprop="name">Make static web site with Clojure and host it on Amazon S3 and CloudFront</title><link href="/favicon.ico" rel="shortcut icon"><link href="https://plus.google.com/118068495795214676039" rel="publisher"><link href="humans.txt" rel="author"><link href="https://github.com/hashobject/blog.hashobject.com/issues/3" rel="discussionUrl"><link href="http://blog.hashobject.com/make-static-site-with-clojure-and-host-on-amazon" rel="canonical"><link href="/css/app.css" rel="stylesheet" type="text/css"><link href="http://fonts.googleapis.com/css?family=PT+Sans" rel="stylesheet" type="text/css"></head><body><header class="row"><div class="small-12"><a href="http://blog.hashobject.com"><div class="logo"></div></a><nav role="navigation"><ul><li><a href="http://hashobject.com">Home</a></li><li class="active"><a href="http://blog.hashobject.com">Blog</a></li><li><a href="http://os.hashobject.com">Open Source</a></li></ul></nav></div></header><div class="row"><div class="post small-12 columns"><h1 itemprop="name">Make static web site with Clojure and host it on Amazon S3 and CloudFront</h1><p><!-- name: Make static web site with Clojure and host it on Amazon S3 and CloudFront description: Short guide how to create static web site using Clojure and host it on Amazon S3 and CloudFront author: Anton Podviaznikov author_email: anton@hashobject.com author_url: http://hashobject.com/team/anton author_github: podviaznikov author_twitter: podviaznikov author_avatar: /images/anton-avatar.png location: Tegucigalpa, Honduras date_created: 2013-07-06 date_modified: 2013-07-06 date_published: 2013-07-06 headline: in_language: en keywords: clojure, amazon s3, web site, amazon route 53, amazon cloudfront, markdown, html, github, amazon route 53, clojure hiccup discussion_url: https://github.com/hashobject/blog.hashobject.com/issues/3 canonical_url: http://blog.hashobject.com/make-static-site-with-clojure-and-host-on-amazon --><h2>Intro</h2></p><p>We decided to host our own <a href='http://hashobject.com'>site</a>, <a href='http://hashobject.com'>blog</a> and <a href='http://os.hashobject.com'>open source corner</a> sites on Amazon S3.</p><p>I'll not go into details about reasoning for that but rather try to explain technology used.</p><p><h2>Technology</h2></p><p>There are a lot of articles on the Internet how to make you custom blog using <a href='http://jekyllrb.com/'>Jekyll</a> and host it on Amazon <a href='http://www.savjee.be/2013/02/howto-host-jekyll-blog-on-amazon-s3/'>1</a>, <a href='http://vvv.tobiassjosten.net/development/jekyll-blog-on-amazon-s3-and-cloudfront/'>2</a>.</p><p>Our approach was very similar to one described in these articles but instead of Jekyll we used custom <a href='https://github.com/hashobject/blog.hashobject.com/blob/master/src/blog/hashobject/generator.clj'>Clojure code</a>.</p><p>Our code is very similar to standalone Clojure library for sites generation called <a href='https://github.com/samrat/ecstatic'>ecstatic</a>.</p><p>It's pretty trivial to generate HTML code in any programming language. In Clojure we are using <a href='https://github.com/weavejester/hiccup'>Hiccup library</a>.</p><p>After you have static site (html, css, images etc) you can host it on Amazon S3. Please see <a href='http://docs.aws.amazon.com/AmazonS3/latest/dev/WebsiteHosting.html'>official documentation</a> how to do that.</p><p>Hosting your static web sites has already amazing benefits:</p><ul><li>your site will be served very fast to clients</li><li>Amazon will handle all load when someday you'll get a lot of users/traffic</li><li>it's very cheap</li></ul><p>However you can improve speed dramatically even more. For that you need <a href='https://aws.amazon.com/cloudfront/'>Amazon CloudFront</a>.CloudFront is Amazon's own Content Distribution Network. Amazon basically will push your static site to the hundreads(thouthands?) of servers located in different parts of the world. So e.x. if some user will visit your site from far country your site will not be served from e.x. US East cost but from closest server to that user.</p><p></p><h2>Configure Amazon CloudFront for S3 bucket</h2><p>Please read <a href='http://docs.aws.amazon.com/AmazonCloudFront/2012-03-15/GettingStartedGuide/StartingCloudFront.html'>official documentation</a> how to configure CloudFront to work with site deployed to your S3 bucket.</p><p>I would give you just one small tip. If you have S3 bucket with the name example.com CloudFront will suggest <code>example.com.s3.amazonaws.com</code> as Origin Domain Name during distribution creation. If you choose such name you may have some troubles: 'example.com/some-folder' will not be resolved automatically to 'example.com/some-folder/index.html'. I suggest to use full endpoint name for your S3 bucket. E.x. for bucket hosted on the US East <code>example.com.s3-website-us-east-1.amazonaws.com</code></p><p>After creating 'Content distribution' on Amazon CloudFront for your site you should change your DNS records. Basically you need some way to resolve DNS name of your site (e.x. <a href='http://os.hashobject.com'>http://os.hashobject.com</a>) into CloudFront URL for your distribution. Luckily if you already using <a href='https://aws.amazon.com/route53/'>Amazon Route 53</a> it will be super easy to do. You need to create new Record Set of type 'A' for your domain name. Then just select Alias and pickup your CloudFront distribution you just created.</p><p></p><h2>What can be improved</h2><p>Right now I need manually run build commands to regenerate HTML content from Markdown. Ideally this can be done automatically. E.x. site generator can be hosted on Heroku and it can be executed automatically (to generate HTML and deploy it to Amazon S3) when somebody pushes changes to GitHub repository where source hosted.</p><aside class="post-meta small-12 columns"><img class="author-avatar" src="/images/anton-avatar.png"><div class="meta-info"><div><span class="meta-label">Written by</span><a class="author-name" href="http://hashobject.com/team/anton">Anton Podviaznikov</a></div><div><span class="meta-label">Published: </span><span>Jul 06, 2013</span></div><div><span class="meta-label">Modified: </span><span>Jul 06, 2013</span></div><div><span class="meta-label">Published in: </span><span>Tegucigalpa, Honduras</span></div></div></aside></div><footer class="post-discussion small-12 columns"><p class="discussion-link">Discussion for this post available on <a href="https://github.com/hashobject/blog.hashobject.com/issues/3">GitHub</a>.</p></footer></div><footer class="row"><div class="content"><p class="licence">Except as otherwise noted, the content of this site is licensed
     under the <a href='http://creativecommons.org/licenses/by/3.0/'>Creative Commons Attribution 3.0 License</a>,
     and code samples are licensed under the
     <a href='http://opensource.org/licenses/eclipse-1.0'>Eclipse Public License 1.0</a>.</p></div></footer></body></html>